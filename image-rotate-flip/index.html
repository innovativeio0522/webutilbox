<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Rotate & Flip - Rotate and Flip Images Online | ToolKit Pro</title>
    <meta name="description" content="Rotate and flip images online for free. Rotate 90Â°, 180Â°, 270Â° or flip horizontally and vertically. Works offline.">
    <meta name="keywords" content="rotate image, flip image, image rotation, mirror image">
    <link rel="canonical" href="https://yourdomain.com/image-rotate-flip">
    <link rel="stylesheet" href="../assets/css/common.css">
    <link rel="stylesheet" href="../assets/css/tool-specific.css">
</head>
<body>
    <header>
        <div class="header-content">
            <a href="../" class="logo">
                <span>ğŸ§°</span>
                <span>ToolKit Pro</span>
            </a>
        </div>
    </header>

    <div class="container">
        <h1>ğŸ”„ Image Rotate & Flip</h1>
        <p class="subtitle">Rotate images by 90Â°, 180Â°, 270Â° or flip horizontally and vertically.</p>

        <div class="workspace" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
            <!-- Left: Upload & Preview -->
            <div>
                <div id="uploadArea" style="margin-bottom: 12px;">
                    <div style="border: 2px dashed var(--border); border-radius: 8px; padding: 25px; text-align: center; cursor: pointer; transition: all 0.3s;" id="dropZone" onclick="document.getElementById('fileInput').click()">
                        <div style="font-size: 2rem; margin-bottom: 5px;">ğŸ“</div>
                        <div style="font-size: 0.85rem; color: var(--white); margin-bottom: 3px;">Click to upload</div>
                        <div style="font-size: 0.7rem; color: var(--gray);">JPG, PNG, WebP</div>
                    </div>
                    <input type="file" id="fileInput" accept="image/*" style="display: none;" onchange="handleFile(this.files[0])">
                </div>

                <!-- Preview Canvas -->
                <div id="previewArea" style="display: none; background: var(--light); border-radius: 8px; padding: 12px; border: 1px solid var(--border);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                        <div style="font-size: 0.75rem; color: var(--gray);">Preview</div>
                        <button onclick="uploadNew()" style="padding: 4px 10px; font-size: 0.7rem; background: var(--primary); border: none; border-radius: 4px; color: white; cursor: pointer;">ğŸ“ Upload New</button>
                    </div>
                    <canvas id="canvas" style="max-width: 100%; max-height: 400px; border-radius: 6px;"></canvas>
                    <div style="margin-top: 8px; font-size: 0.75rem; color: var(--gray);" id="dimensions">-</div>
                </div>
            </div>

            <!-- Right: Controls -->
            <div id="controls" style="display: none;">
                <!-- Rotate -->
                <div style="background: var(--light); border-radius: 8px; padding: 12px; margin-bottom: 12px; border: 1px solid var(--border);">
                    <div style="font-size: 0.85rem; color: var(--gray); margin-bottom: 10px;">Rotate</div>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px;">
                        <button onclick="rotate(90)" class="btn btn-secondary" style="padding: 10px; font-size: 0.85rem; display: flex; flex-direction: column; align-items: center; gap: 4px;">
                            <span style="font-size: 1.5rem;">â†»</span>
                            <span>90Â° Right</span>
                        </button>
                        <button onclick="rotate(180)" class="btn btn-secondary" style="padding: 10px; font-size: 0.85rem; display: flex; flex-direction: column; align-items: center; gap: 4px;">
                            <span style="font-size: 1.5rem;">â†»</span>
                            <span>180Â°</span>
                        </button>
                        <button onclick="rotate(-90)" class="btn btn-secondary" style="padding: 10px; font-size: 0.85rem; display: flex; flex-direction: column; align-items: center; gap: 4px;">
                            <span style="font-size: 1.5rem;">â†º</span>
                            <span>90Â° Left</span>
                        </button>
                    </div>
                </div>

                <!-- Flip -->
                <div style="background: var(--light); border-radius: 8px; padding: 12px; margin-bottom: 12px; border: 1px solid var(--border);">
                    <div style="font-size: 0.85rem; color: var(--gray); margin-bottom: 10px;">Flip</div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                        <button onclick="flip('horizontal')" class="btn btn-secondary" style="padding: 10px; font-size: 0.85rem; display: flex; flex-direction: column; align-items: center; gap: 4px;">
                            <span style="font-size: 1.5rem;">â†”ï¸</span>
                            <span>Horizontal</span>
                        </button>
                        <button onclick="flip('vertical')" class="btn btn-secondary" style="padding: 10px; font-size: 0.85rem; display: flex; flex-direction: column; align-items: center; gap: 4px;">
                            <span style="font-size: 1.5rem;">â†•ï¸</span>
                            <span>Vertical</span>
                        </button>
                    </div>
                </div>

                <!-- Current Transformations -->
                <div style="background: var(--light); border-radius: 8px; padding: 12px; margin-bottom: 12px; border: 1px solid var(--border);">
                    <div style="font-size: 0.85rem; color: var(--gray); margin-bottom: 8px;">Current Transformations</div>
                    <div style="font-size: 0.75rem; color: var(--white);">
                        <div style="margin-bottom: 4px;">Rotation: <span style="color: var(--primary);" id="rotationDisplay">0Â°</span></div>
                        <div style="margin-bottom: 4px;">Horizontal Flip: <span style="color: var(--primary);" id="hFlipDisplay">No</span></div>
                        <div>Vertical Flip: <span style="color: var(--primary);" id="vFlipDisplay">No</span></div>
                    </div>
                </div>

                <!-- Actions -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                    <button onclick="reset()" class="btn btn-secondary" style="padding: 10px; font-size: 0.9rem;">ğŸ”„ Reset</button>
                    <button onclick="downloadImage()" class="btn btn-success" style="padding: 10px; font-size: 0.9rem;">ğŸ’¾ Download</button>
                </div>
            </div>
        </div>

        <div class="info-section">
            <h2>Image Rotate & Flip - Transform Images Online</h2>
            <p>Rotate images by 90Â°, 180Â°, or 270Â° (clockwise or counter-clockwise). Flip images horizontally (mirror) or vertically. Perfect for fixing image orientation or creating mirror effects.</p>
            <p><strong>Use Cases:</strong> Fix rotated photos, create mirror images, adjust image orientation for social media, correct camera orientation.</p>
            <p><strong>Privacy:</strong> All transformations happen in your browser. No files uploaded to any server.</p>
        </div>
    </div>

    <div id="toast" class="toast">
        <span id="toastMessage">Success!</span>
    </div>

    <script>
        let originalImage = null;
        let canvas, ctx;
        let currentRotation = 0;
        let horizontalFlip = false;
        let verticalFlip = false;

        // Drag and drop
        const dropZone = document.getElementById('dropZone');
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.style.borderColor = 'var(--primary)';
            dropZone.style.background = 'rgba(249, 115, 22, 0.1)';
        });
        dropZone.addEventListener('dragleave', () => {
            dropZone.style.borderColor = 'var(--border)';
            dropZone.style.background = 'transparent';
        });
        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.style.borderColor = 'var(--border)';
            dropZone.style.background = 'transparent';
            if (e.dataTransfer.files.length) {
                handleFile(e.dataTransfer.files[0]);
            }
        });

        function handleFile(file) {
            if (!file || !file.type.startsWith('image/')) {
                showToast('Please select an image', true);
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                originalImage = new Image();
                originalImage.onload = () => {
                    reset();
                    document.getElementById('uploadArea').style.display = 'none';
                    document.getElementById('previewArea').style.display = 'block';
                    document.getElementById('controls').style.display = 'block';
                };
                originalImage.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function rotate(degrees) {
            currentRotation = (currentRotation + degrees) % 360;
            if (currentRotation < 0) currentRotation += 360;
            updateDisplay();
        }

        function flip(direction) {
            if (direction === 'horizontal') {
                horizontalFlip = !horizontalFlip;
            } else {
                verticalFlip = !verticalFlip;
            }
            updateDisplay();
        }

        function reset() {
            currentRotation = 0;
            horizontalFlip = false;
            verticalFlip = false;
            updateDisplay();
        }

        function updateDisplay() {
            if (!originalImage) return;

            canvas = document.getElementById('canvas');
            ctx = canvas.getContext('2d');

            // Calculate canvas size based on rotation
            let width = originalImage.width;
            let height = originalImage.height;

            if (currentRotation === 90 || currentRotation === 270) {
                // Swap dimensions for 90Â° and 270Â° rotations
                canvas.width = height;
                canvas.height = width;
            } else {
                canvas.width = width;
                canvas.height = height;
            }

            // Scale canvas to fit preview area
            const maxWidth = 450;
            const maxHeight = 400;
            const scale = Math.min(1, maxWidth / canvas.width, maxHeight / canvas.height);
            const displayWidth = canvas.width * scale;
            const displayHeight = canvas.height * scale;
            canvas.style.width = displayWidth + 'px';
            canvas.style.height = displayHeight + 'px';

            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Save context state
            ctx.save();

            // Move to center
            ctx.translate(canvas.width / 2, canvas.height / 2);

            // Apply rotation
            ctx.rotate((currentRotation * Math.PI) / 180);

            // Apply flips
            ctx.scale(horizontalFlip ? -1 : 1, verticalFlip ? -1 : 1);

            // Draw image centered
            ctx.drawImage(originalImage, -width / 2, -height / 2, width, height);

            // Restore context state
            ctx.restore();

            // Update display info
            document.getElementById('rotationDisplay').textContent = currentRotation + 'Â°';
            document.getElementById('hFlipDisplay').textContent = horizontalFlip ? 'Yes' : 'No';
            document.getElementById('vFlipDisplay').textContent = verticalFlip ? 'Yes' : 'No';
            document.getElementById('dimensions').textContent = `${canvas.width} Ã— ${canvas.height} px`;
        }

        function downloadImage() {
            if (!originalImage) return;

            // Create a new canvas with the correct dimensions
            const downloadCanvas = document.createElement('canvas');
            const downloadCtx = downloadCanvas.getContext('2d');

            let width = originalImage.width;
            let height = originalImage.height;

            if (currentRotation === 90 || currentRotation === 270) {
                downloadCanvas.width = height;
                downloadCanvas.height = width;
            } else {
                downloadCanvas.width = width;
                downloadCanvas.height = height;
            }

            // Apply transformations
            downloadCtx.save();
            downloadCtx.translate(downloadCanvas.width / 2, downloadCanvas.height / 2);
            downloadCtx.rotate((currentRotation * Math.PI) / 180);
            downloadCtx.scale(horizontalFlip ? -1 : 1, verticalFlip ? -1 : 1);
            downloadCtx.drawImage(originalImage, -width / 2, -height / 2, width, height);
            downloadCtx.restore();

            // Download
            downloadCanvas.toBlob((blob) => {
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'transformed_' + Date.now() + '.png';
                a.click();
                URL.revokeObjectURL(url);
                showToast('Image downloaded!');
            });
        }

        function showToast(message, isError = false) {
            const toast = document.getElementById('toast');
            const msg = document.getElementById('toastMessage');
            msg.textContent = message;
            toast.className = 'toast show' + (isError ? ' error' : '');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        function uploadNew() {
            document.getElementById('fileInput').click();
        }
    </script>
</body>
</html>
